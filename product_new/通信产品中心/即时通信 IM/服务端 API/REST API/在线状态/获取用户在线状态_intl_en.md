## Feature Description
This API is used to obtain the current login state of users.

## API Calling Description
### Request URL example
```
https://console.tim.qq.com/v4/openim/querystate?sdkappid=88888888&identifier=admin&usersig=xxx&random=99999999&contenttype=json
```
### Request parameters

The following table lists only the parameters to be modified when this API is called. For details on other parameters, see [RESTful API Overview](https://intl.cloud.tencent.com/document/product/1047/34620).

| Parameter | Description |
| ------------------ | ------------------------------------ |
| v4/openim/querystate | The request API. |
| sdkappid | The SDKAppID assigned by the IM console when an app is created. |
| identifier | This must be the app admin account. For details, see [App Admins](https://intl.cloud.tencent.com/document/product/1047/33517#app-.E7.AE.A1.E7.90.86.E5.91.98). |
| usersig | The signature generated by the app admin account. For details, see [Generating UserSig](https://intl.cloud.tencent.com/document/product/1047/34385). |
| random | Enter a random 32-bit unsigned integer ranging from 0 to 4294967295. |

### Maximum calling frequency

The maximum calling frequency is 200 times per second.

### Request packet example
```
{
    "To_Account": ["id1", "id2", "id3"]
}

```

### Request packet fields

| Field | Type | Attribute | Description |
|---------|---------|---------|---------|
| To_Account | Array | Required | Identifiers whose login states will be queried. The login states of up to 500 identifiers can be queried at a time. |

### Response packet example

```
{
    "ActionStatus": "OK",
    "ErrorInfo": "",
    "ErrorCode": 0,
    "QueryResult": [
        {
            "To_Account": "id1",
            "State": "Offline"
        },
        {
            "To_Account": "id2",
            "State": "Online"
        },
        {
            "To_Account": "id3",
            "State": "PushOnline"
        }
    ]
}

```
```
{
    "ActionStatus": "FAIL",
    "ErrorInfo": "Fail to Parse json data of body, Please check it",
    "ErrorCode": 90001
}
```

### Response packet fields

| Field | Type | Description |
|---------|---------|---------|
| ActionStatus | String | The request processing result. OK: succeeded. FAIL: failed. |
| ErrorCode | Integer | The error code. 0: succeeded. Others: failed. |
| ErrorInfo | String | Detailed error information. |
| QueryResult | Array | The structured information of the returned user online state. |
| To_Account | String | The identifier of the returned user. |
| State | String | The returned user state. Currently, the following states are supported: <br>1. "Online": the client established a persistent connection with the IM backend after login. <br>2. "PushOnline": the iOS or Android process was killed or disconnected from the IM backend due to a network problem. Therefore, the user enters the PushOnline state, but can still receive messages that are pushed offline. (If the client is switched to the background but the process is not killed by the mobile operating system, the user remains in the Online state.) <br>3. "Offline": the client has logged out, or the user has not logged in to the client in 7 days since the previous login. |

> The IM console stores the PushOnline state for up to 7 days. If the user has not logged in to the client in 7 days since the previous login, the user enters the Offline state.

## Error Codes
Unless a network error (such as error 502) occurs, the HTTP return code for this API is always 200. ErrorCode and ErrorInfo in the response packet represent the actual error code and error information, respectively.
For common error codes (60000 to 79999), see [Error Codes](https://intl.cloud.tencent.com/document/product/1047/34348).
The following table describes the error codes specific to this API.

| Error Code | Description |
|---------|---------|
| 90001 | Failed to parse the JSON string. To correct it, check whether the request packet meets the JSON specification, or whether To_Account is an empty array. |
| 90003 | To_Account in the JSON request packet does not meet the message format requirement. To correct it, check whether To_Account is of the String type. |
| 90009 | The request requires app admin permission. |
| 90011 | The number of target accounts to which messages will be sent exceeds 500. To correct it, reduce the number of target accounts in To_Account. |
| 90992 | The backend service timed out. To correct it, try again. |
| 90994 | An internal server error occurred. To correct it, try again. |
| 90995 | An internal server error occurred. To correct it, try again. |
| 91000 | An internal server error occurred. To correct it, try again. |

## API Commissioning Tool
Use the [online commissioning tool for RESTful APIs](https://avc.qcloud.com/im/APITester/APITester.html#v4/openim/querystate) to commission this API.
