 DDoS 고도 방어 IP 제품은 프록시 포워딩의 모드로 인터넷 비즈니스 서비스에 대해 대량 트래픽 DDoS 공격에 대응하는 방어 서비스와 트래픽 클리닝 서비스를 제공합니다. 사용자는 간단한 구성을 통해 비즈니스 트래픽과 공격 트래픽을 DDoS 고도 방어 IP로 지향할 수 있습니다. 공격 트래픽이 고도 방어 IP를 지나칠 때, 비즈니스가 DDoS 공격 하에도 가용성을 확보하기 위해 방어 시스템은 감지 및 클리닝 작업을 수행하고, 클리닝된 비즈니스 트래픽을 포워딩하고 오리진 서버에 발송합니다.
 
이 문서는 DDoS 고도 방어 IP 구성 온라인의 절차를 자세히 설명합니다. 구매 구성에 대한 세부 정보는 [**제품 구성 설명**](https://cloud.tencent.com/document/product/685/18798)을 참조하십시오.

## 프로세스도
![0](https://main.qcloudimg.com/raw/b302ad5d4b7a88a9dfa5ac2095925f21.png)

## 액세스 절차
1. **DDoS 고도 방어 IP 구매**
a. 사용자는 [Aegis 고도 방어 콘솔](https://console.cloud.tencent.com/gamesec)에 진입하여 좌측 디렉터리에서 [DDoS 고도 방어 IP]를 클릭하고, “고도 방어 IP 리스트”에서 [구매]를 클릭합니다.

![1](https://main.qcloudimg.com/raw/3a0695702ab90206f2c3f393390211e7.png)
b. 비즈니스 요구에 따라 필요한 구성을 선택하고, 구성을 확인한 후에 [바로 구매]를 클릭합니다.
![2](https://main.qcloudimg.com/raw/eb18e84c56e06cc5616a5d4ebb949982.png)
2. **고도 방어 IP 포워딩 규칙 그룹 추가**
a. "DDoS 고도 방어 IP”에서 [포워딩 규칙 그룹]을 클릭하고, [포워딩 규칙 그룹 추가]를 클릭합니다.
b. "새로운 규칙 그룹 이름"을 입력하고, "포워딩 모드"와 "소속 프로젝트"를 선택한 후, [확인]을 클릭합니다.
![3](https://main.qcloudimg.com/raw/60545be9f308f918982a71a35721e38c.png)
>**설명:**
>각 포워딩 규칙 그룹은 기본적으로 60개 포워딩 규칙을 무료로 제공합니다.

3. **포워딩 규칙 추가**
a. 포워딩 규칙 그룹을 생성한 후에, [포워딩 규칙 그룹 ID]를 클릭하여 "포워딩 규칙 그룹 세부 정보" 페이지에 진입합니다.
![4](https://main.qcloudimg.com/raw/9820c1c3c50c49a37a8eca4ca09468ec.png)
b. [규칙 그룹 정보]에서 [포워딩 규칙 추가]를 클릭하면 4계층 포트를 기반한 포워딩 규칙을 추가할 수 있습니다. 비즈니스 프로토콜 요구에 따라 "프로토콜 유형"을 선택하고 '세션 유지' 스위치를 구성하고 적합한 “폴링 전략”을 선택한 뒤, "포워딩 포트" 번호, "오리진 서버 포트" 번호와 "오리진 서버 공인 IP와 가중치"를 입력합니다. 포워딩 규칙을 생성하면 배치 추가를 지원하는 것으로 간주되고 [확인]을 클릭합니다.
![5](https://main.qcloudimg.com/raw/93d364b8580efc644ef8d12341c9b2bf.png)
>**설명:**
각 포워딩 규칙은 40개 오리진 서버 공인 IP를 구성할 수 있습니다.

 **프로토콜 유형**: 서비스를 선택할 포트의 프로토콜 유형입니다. TCP 또는 UDP 프로토콜을 지원합니다.
 **세션 유지**: 세션 유지를 시작하면 서로 관련이 있는 접근 요청이 동일한 서버에 할당될 수 있도록 보장합니다. 동일한 포워딩 규칙에 오리진 서버 IP가 여러 개가 있는 경우, 동일한 클라이언트의 요청을 동일 서버로 처리해야 하면 세션 유지를 시작해야 합니다.
 **폴링 전략**: 동일한 포워딩 규칙에 오리진 서버 IP가 여러 개가 있는 경우, 가중치로 폴링 또는 최소 연결 수로 폴링을 선택하고 백엔드 오리진 서버가 비즈니스 요청을 처리한 비중을 할당할 수 있습니다. 가중치 폴링은 오리진 서버 IP 가중치에 따라 할당합니다. 최소 연결 수 폴링은 공인 IP 최소 연결 수에 따라 할당합니다.
  **포워딩 포트**: 고도 방어 IP에서 서비스를 제공해야 하는 포트 번호를 가리킵니다. 클라이언트 또는 사용자의 비즈니스 요청이 고도 방어 IP의 해당 포트에 직접 접근하게 됩니다.
  **오리진 서버 포트**: 오리진 서버가 제공하는 서비스의 포트 번호를 가리키며 포워딩 포트와 대응됩니다. 고도 방어 IP는 사용자가 포워딩 포트의 비즈니스 요청을 오리진 서버 IP의 오리진 서버 포트로 포워딩하고 처리합니다.
 **오리진 서버 공인 IP와 가중치**: 서비스를 제공하는 백엔드 오리진 서버의 IP 주소를 가리킵니다. 오리진 서버 공인 IP가 여러 개가 있는 경우, 고도 방어 IP는 비즈니스 요청을 각 오리진 서버 IP에 폴링합니다. 설정한 가중치는 해당 오리진 서버 IP가 처리한 비즈니스 요청 비율을 의미하며, 가중치가 클수록 수신한 비즈니스 요청 수가 많아집니다.
>**주의:**
> - 포워딩 규칙이 여러 개가 있는 경우 배치로 생성할 수 있습니다. 포워딩 포트와 오리진 서버 포트 입력 창에 여러 개의 포트 번호를 개별적으로 입력하고 쉼표로 구분합니다. 포워딩 규칙은 포트 순서 관계에 따라 하나씩 생성됩니다.
> - 아래 포트 번호는 포워딩 클러스터 유지 포트이고, 포워딩 포트: 843, 3306, 1433, 1434, 36000, 56000, 3389로 추가할 수 없습니다.

4. **고도 방어 IP에 포워딩 규칙 그룹 바인딩**
포워딩 규칙 그룹을 생성한 후, "DDoS 고도 방어 IP"에서 [포워딩 규칙 그룹]을 클릭하고, "작업" 줄에서 [고도 방어 IP 관련]을 클릭하면 해당 포워딩 규칙 그룹을 고도 방어 IP로 바인딩합니다.
![6](https://main.qcloudimg.com/raw/2c0913543515550b303d0787cceba81c.png)
"DDoS 고도 방어 IP"에서 "고도 방어 IP"를 선택하여 "DDoS 고도 방어 IP 세부 정보" 페이지에 진입할 수도 있습니다. [기초 구성]을 클릭하여, "포워딩 규칙 그룹 설정" 프로젝트에서 [바인딩]을 클릭하여 고도 방어 IP에 포워딩 규칙 그룹을 바인딩합니다.
![7](https://main.qcloudimg.com/raw/d803baba55c852f1923db6d77fb0d7bb.png)
![8](https://main.qcloudimg.com/raw/41a39ce289626921a4b82dcb3162fed5.png)

5. **고도 방어 IP로 비즈니스 구성**
 고도 방어 IP에 포워딩 규칙 그룹을 바인딩한 후에, 사용자는 고도 방어 IP의 포워딩 포트부터 오리진 서버의 오리진 서버 포트까지의 연결성을 검증할 수 있습니다. 고도 방어 IP로 비즈니스를 구성하면 고도 방어 IP의 액세스 구성이 완료됩니다. 사용자 비즈니스가 이전에 도메인 이름 해석을 사용했다면, 사용자는 비즈니스 도메인 이름 해석 서비스 업체에서 도메인 이름 해석을 변경할 수 있으며 기존 IP 주소는 바인딩한 고도 방어 IP 주소로 변경됩니다. 
구성한 후에, 사용자의 오리진 서버는 고도 방어 IP의 방어를 받게 됩니다.

6. **CNAME 방어 도메인 이름**
사용자는 비즈니스 도메인 이름 해석 서비스 업체에 CNAME 해석을 방어 도메인 이름 액세스를 추가하면 무료로 방어 도메인 이름을 생성할 수 있습니다. 구성 세부 정보는 [**방어 도메인 이름에 고도 방어 IP 바인딩**](https://cloud.tencent.com/document/product/685/18808)을 참조하십시오.

