## 現象の説明
VNCを使用してCVMにログインする際、正しいパスワードを入力してもログインできない場合は、下図のような画面が表示されます。しばらくすると再びアカウント入力が必要であるとのメッセージが表示されます。
![](https://main.qcloudimg.com/raw/13b30f4ccfc97afd0e704e2e5c600047.png)
また、SSHを使用したリモートログインの際、エラーメッセージ“Permission denied,please try again.”が表示される（下図参照）。
![](https://main.qcloudimg.com/raw/db09e73d2a057fb8b297ffd31bf67b62.png)

## 考えられる原因
頻繁な総当たり攻撃によって`/var/log/btmp`のログ容量が大きくなりすぎたことが原因の可能性があります。このファイルはエラーログインのログの記録に用いられ、容量が大きすぎるとログイン時のログの書き込みに異常が生じ、正常なログインができなくなります。下図に示します。
![](https://main.qcloudimg.com/raw/c19f9e57a67ce6b1ed30cee22af9964c.png)

## 解決方法
1. [処理手順](#ProcessingSteps)を参照し、ログファイル`/var/log/btmp`の容量が大きすぎないか確認します。
2. 総当たり攻撃によるものかどうかを確認し、セキュリティポリシーを強化します。

## 処理手順[](id:ProcessingSteps)
1. SSHを使用したCVMインスタンスへのログインを試してください。詳細については[SSHを使用してLinuxインスタンスにログイン](https://intl.cloud.tencent.com/document/product/213/32501)をご参照ください。
	- ログインに成功した場合は次の手順に進みます。
	- ログインに失敗しました。シングルユーザーモードを使用する必要があります。詳細については、[コンソールを介してLinuxインスタンスシングルユーザーモードに進む](https://intl.cloud.tencent.com/document/product/213/34819)をご参照ください。
2. `/var/log`に入り、ログファイル`/var/log/btmp`の容量を確認します。
3. ログファイル`/var/log/btmp`の容量が大きすぎる場合は、次のコマンドを実行し、btmpログの内容をクリアします。ログファイルをクリアすると、ログインできるようになります。
```
cat /dev/null > /var/log/btmp
```
5. アカウントのロックが人為的な誤操作によるものか、総当たり攻撃によるものかを確認します。総当たり攻撃によって起こった場合は、次の方法でセキュリティポリシーを強化することを推奨します。
	- CVMのパスワードを変更し、大文字、小文字、特殊記号、数字を組み合わせた12～16桁の複雑なランダムパスワードを設定します。詳細については、[インスタンスのパスワードをリセット](https://intl.cloud.tencent.com/document/product/213/16566)をご参照ください。
	- CVM内の使われていないユーザーを削除します。
	- sshdのデフォルトの22ポートを1024～65525の間の他の非常用ポートに変更します。詳細については、[CVMリモートデフォルトポートの変更](https://intl.cloud.tencent.com/document/product/213/35376)をご参照ください。
	- CVMのセキュリティグループに関連付けられているルールを管理し、業務およびプロトコルに必要なポートのみをオープンにし、すべてのプロトコルおよびポートをオープンにはしないことを推奨します。詳細については、[セキュリティグループルールの追加](https://intl.cloud.tencent.com/document/product/213/34272)をご参照ください。
	- mysql、redisなどのパブリックネットワークにコアアプリケーションサービスポートへのアクセスを開放することは推奨しません。 関連するポートをローカルアクセスに変更、または外部ネットワークアクセス禁止にすることができます。
	- 「雲鏡」、「雲鎖」などの保護ソフトウェアをインストールし、リアルタイムアラームを追加して、異常なログイン情報を速やかに取得できるようにします。
