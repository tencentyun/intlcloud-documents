Media Processing Serviceはオーディオビデオファイルをさまざまなビットレートと解像度のフォーマットに変換し、さまざまなネットワーク帯域幅と端末デバイスのユーザーのニーズを満たします。以下の機能をサポートしています。

## オーディオビデオトランスコーディング
トランスコードは、元のオーディオビデオストリームを別のオーディオビデオストリームに変換するオフラインタスクです。トランスコードによって、コーデック、解像度、ビットレートなどの元のビットストリームのパラメータを変更して、さまざまなデバイスやネットワーク環境での再生に適応させます。トランスコードによって以下の機能を実現できます。
<table>
<tr><th width=19%>実装可能な機能</th><th>説明</th></tr>
<tr>
<td>より多くの端末に適応</td>
<td>元のビデオを端末適応性の高い形式（例：MP4）にトランスコードして、ビデオリソースをより多くのデバイスで再生できるようにします</td>
</tr>
<tr>
<td>さまざまな帯域幅に適応</td>
<td>ビデオをLD、SD、HDおよびFHD出力などに変換します。ユーザーは現在のネットワーク環境に応じて、ビデオ再生に適したビットレートを選択できます</td>
</tr>
<tr>
<td>再生効率の向上</td>
<td>トランスコードにより、MP4の末尾にあるソース情報MOOVをあらかじめ先頭にもってくることができるので、プレーヤーは完全なビデオをダウンロードせずに、すぐに再生することができます</td>
</tr>
<tr>
<td>帯域幅の節約</td>
<td>より高度なコーデック（例：H.265）を使用してトランスコードすることで、元の画質を失うことなく、ビットレートを大幅に削減し、再生帯域幅を削減できます</td>
</tr>
</table>


トランスコードの目標仕様には、コーデック、解像度、ビットレートなどのパラメータが含まれます。以下のトランスコード関連パラメータがカスタマイズ可能です。

<table>
   <tr>
      <th width="15%" style="text-align:center">パラメータ</td>
      <th width="17%" style="text-align:center">タイプ</td>
      <th  style="text-align:center">詳細説明</td>
   </tr>
   <tr>
      <td rowspan='3' style="text-align:center">入力形式</td>
      <td style="text-align:center">コンテナ形式</td>
      <td>3GP,AVI,FLV,MP4,M3U8,MPG,ASF,WMV,MKV,MOV,TS,WebM,MXF</td>
   </tr>
   <tr>
      <td style="text-align:center">ビデオコーデック形式</td>
      <td>AV1,AVS2,H.264/AVC,H.263, H.263+,H.265,MPEG-1,MPEG-2,MPEG-4,MJPEG,VP8,VP9,RealVideo,Windows Media Video,Quicktime</td>
   </tr><tr>
      <td style="text-align:center">オーディオコーデック形式</td>
      <td>AAC,ADPCM,AMR,DSD,MP1,MP2,MP3,PCM,RealAudio,Windows Media Audio,VORBIS,AC-3</td>
   </tr>
   <tr>
      <td rowspan='5' style="text-align:center">出力形式</td>
      <td rowspan='3' style="text-align:center">コンテナ形式</td>
      <td>ビデオ：FLV、MP4、HLS（m3u8+ts）、MXF</td>
   </tr><tr>
      <td>オーディオ：MP3、MP4、OGG、FLAC、m4a</td>
   </tr><tr>
      <td>画像：GIF、WEBP</td>
   </tr>
   <tr>
      <td style="text-align:center">ビデオコーデック形式</td>
      <td>H.264/AVC, H.265/HEVC,AV1</td>
   </tr><tr>
      <td style="text-align:center">オーディオコーデック形式</td>
      <td>MP3,AAC,FLAC,MP2,VORBIS</td>
   </tr><tr>
			 <td rowspan='2' style="text-align:center">コンテナ</td>
      <td style="text-align:center">ビデオストリームの削除</td>
      <td>「ビデオストリームの削除」を有効にすると、トランスコードしたビデオにはビデオストリームが含まれません（オーディオストリームのみ残ります）</td>
   </tr>
	 	 	   <tr>
      <td style="text-align:center">オーディオコーデック形式</td>
      <td>「オーディオストリームの削除」を有効にすると、トランスコードしたビデオにはオーディオストリームが含まれません（ビデオストリームのみ残ります）</td>
</table>


## ウォーターマーク
ウォーターマークの追加は、ビデオのトランスコーディングまたはスクリーンキャプチャ時に、特定の画像を画面の指定位置に追加するプロセスであり、オフラインタスクです。MPSでは以下のタイプのウォーターマークをサポートしています。
- **静的画像ウォーターマーク**：PNG形式の画像ウォーターマーク。版権元のLOGO、放送局ロゴなど、通常、ビデオの版権の帰属の表示に利用されます。
- **動的画像ウォーターマーク**：APNG形式の動的画像ウォーターマーク。ウォーターマーク画像のダイナミックな変化による效果を実現できます。

MPSではビデオまたはスクリーンキャプチャに対する複数のウォーターマークの追加をサポートし、各ウォーターマークの画面の中でのサイズと位置を指定できます。

ウォーターマークの目標仕様には、ウォーターマークのタイプ、幅と高さ、位置などのパラメータが含まれます。以下のウォーターマーク関連パラメータがカスタマイズ可能です。

| パラメータ                     | 説明                                                         |
| ------------------------ | ------------------------------------------------------------ |
| ウォーターマークのタイプ（Type）         | 静的画像ウォーターマークと動的画像ウォーターマークをサポート                         |
| ウォーターマーク位置（Position）     | ウォーターマークのビデオ画面上の対応する位置                                 |
| 画像サイズ（ImageSize）    | 画像ウォーターマークがビデオ画面で占める大きさ                                |
| 画像コンテンツ（ImageContent） | 画像ウォーターマークの中の画像のバイナリーコンテンツ                                 |




## ビデオスクリーンキャプチャ

スクリーンキャプチャはビデオの特定の位置の映像を切り取り、画像を生成するプロセスであり、オフラインタスクです。MPSでは次のタイプのスクリーンキャプチャを提供しています。
- **指定タイムポイントのスクリーンキャプチャ**：1組のタイムポイントを指定し、これらのタイムポイントのビデオの画像を切り取ります。
- **サンプリングスクリーンキャプチャ**：同じ時間間隔でビデオから複数枚の画像を切り取ります。
- **スプライトイメージのスクリーンキャプチャ**：同じ時間間隔でビデオから複数枚の小さな画像を切り取り、組み合わせてやや大きめの画像（ [スプライトイメージ](https://intl.cloud.tencent.com/document/product/1041/33504)）を作成します。

スクリーンキャプチャの目標仕様には、スクリーンキャプチャのファイルフォーマット、スクリーンキャプチャの幅と高さなどのパラメータが含まれます。以下のスクリーンキャプチャ関連パラメータがカスタマイズ可能です。

### タイムポイントのスクリーンキャプチャ

| パラメータ     | 説明 |
| -------------------- | ------------------------------------------------------------ |
| 形式（Format）       | スクリーンキャプチャのファイル出力形式。現在はJPGのみをサポートしています                         |
| 幅（Width）        | スクリーンキャプチャの幅。範囲は128px～4096px                             |
| 高さ（Height）     | スクリーンキャプチャの高さ。範囲は128px～4096px                             |
| 塗りつぶしタイプ（FillType）   | スクリーンキャプチャの幅と高さの比率とオリジナルビデオの幅と高さの比率が異なるときに、スクリーンキャプチャの処理方式が、「塗りつぶし」になります。一般的な塗りつぶしタイプには次のようなものがあります。<li>引き伸ばし：画像を引き伸ばして、フレーム全体に広げます。画像は「圧縮されたり」、「長く延びたり」します</li><li>黒で補填：画像の幅と高さの比率は変えず、縁の余った部分は黒で補填します</li><li>白で補填：画像の幅と高さの比率は変えず、縁の余った部分は白で補填します</li><li>ガウシアンぼかし：画像の幅と高さの比率は変えず、縁の余った部分はガウシアンぼかしを入れて画面を埋めます</li> |


### サンプリングスクリーンキャプチャ


| パラメータ                   | 説明                                                         |
| ---------------------- | ------------------------------------------------------------ |
| 形式（Format）         | スクリーンキャプチャのファイル出力形式。現在はJPGのみをサポートしています                         |
| 幅（Width）          | スクリーンキャプチャの幅。範囲は128px～4096px                             |
| 高さ（Height）       | スクリーンキャプチャの高さ。範囲は128px～4096px                             |
| サンプリング方式（SampleType） | サンプリング方式は2種類に分かれます。<li>パーセンテージによるサンプリング：例えば、5%の間隔でサンプリングした場合、生成されるスクリーンキャプチャの枚数は20枚になります</li><li>時間間隔によるサンプリング：例えば、10sの間隔でサンプリングした場合、スクリーンキャプチャの枚数はビデオの長さによって決まります</li> |
| サンプリング間隔（Interval）   | サンプリング間隔の長さ：<li>パーセンテージによるサンプリングの場合、間隔はパーセンテージになります</li><li>時間間隔によるサンプリングの場合、間隔は秒になります</li> |
| 塗りつぶしタイプ（FillType）   | スクリーンキャプチャの幅と高さの比率とオリジナルビデオの幅と高さの比率が異なるときに、スクリーンキャプチャの処理方式が、「塗りつぶし」になります。一般的な塗りつぶしタイプには次のようなものがあります。<li>引き伸ばし：画像を引き伸ばして、フレーム全体に広げます。画像は「圧縮されたり」、「長く延びたり」します</li><li>黒で補填：画像の幅と高さの比率は変えず、縁の余った部分は黒で補填します</li><li>白で補填：画像の幅と高さの比率は変えず、縁の余った部分は白で補填します</li><li>ガウシアンぼかし：画像の幅と高さの比率は変えず、縁の余った部分はガウシアンぼかしを入れて画面を埋めます</li> |


### スプライトイメージ

| パラメータ                   | 説明                                       |
| ---------------------- | ------------------------------------------ |
| 形式（Format）         | スプライトイメージのファイル出力形式。現在はJPGのみをサポートしています     |
| 小さい画像の幅（Width）      | スプライトイメージの中の小さい画像の幅                       |
| 小さい画像の高さ（Height）   | スプライトイメージの中の小さい画像の高さ                       |
| 小さい画像の行数（Rows）       | 1枚の大きな図の中にある小さい図の行数                 |
| 小さい画像の列数（Columns）    | 1枚の大きな図の中にある小さい画像の列数                  |
| サンプリング方式（SampleType） | 小さい画像のサンプリング方式。現在は時間間隔によるサンプリングのみをサポートしています |
| サンプリング間隔（Interval）   | どの位の間隔で1枚の小さい画像をサンプリングするかのサンプリング間隔     |

>!
>- Width × Columnsは128px～4096pxの間にする必要があります（大きい図の幅が128px～4096pxの間）。
>- Height × Rowsは128px～4096pxの間にする必要があります（大きい図の高さが128px～4096pxの間）。



## ビデオのアニメーション画像生成
アニメーション画像生成とは、ビデオフィルムを切り取り、動画（GIF、WEBPなど）を生成するプロセスを指し、オフラインタスクとなります。動画は1組の連続したフレームをシームレスに循環させ、これにより小さい容量でアニメーション効果を実現します。


アニメーション画像生成の目標仕様には、動画のフォーマット、幅と高さ、フレームレートなどのパラメータが含まれます。以下の動画関連パラメータがカスタマイズ可能です。

| パラメータ             | 説明                                         |
| ---------------- | -------------------------------------------- |
| 形式（Format）   | 動画ファイルの出力形式。現在はGIFとWEBPのみをサポートしています |
| 幅（Width）    | 動画の幅。範囲は128px～4096px              |
| 高さ（Height） | 動画の高さ。範囲は128px～4096px              |
| フレームレート（FPS）      | サポートするフレームレート範囲：1fps～60fps                  |

