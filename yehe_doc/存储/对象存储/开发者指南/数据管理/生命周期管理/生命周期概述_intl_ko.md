## 개요

COS(Cloud Object Storage)는 객체 기반의 라이프사이클 설정을 지원하며, 버킷에 대해 지정된 설명 언어를 전달함으로써 규칙에 부합하는 객체가 지정된 조건 아래 자동으로 몇몇 조작을 수행할 수 있습니다.

>?
>- 라이프사이클의 최대 설정 일수는 3,650일입니다.
>- 버킷마다 최대 1,000개까지 라이프사이클 규칙을 추가할 수 있습니다.

## 적용 시나리오

### 로그 기록

사용자가 COS를 사용해 로그 데이터를 저장하면, 라이프사이클 설정을 통해 로그 데이터를 30일 후 자동 보관 또는 2년 후 자동 삭제할 수 있습니다.

### 핫/콜드 티어링

핫 데이터는 업로드 후 보통 짧은 시간 내 대량 액세스로 이슈가 증가하는데, 일정 시간이 지나면 이슈는 점차 낮아지거나 실시간 액세스가 필요 없게 됩니다. 라이프사이클 규칙을 통해 30일 전의 데이터를 표준IA 스토리지로 전환하고 60일 전의 데이터를 CAS로 전환할 수 있습니다. 이 과정을 데이터 전환이라고 합니다.

### 저장 파일 관리

COS를 사용해 저장 파일을 관리할 때는 보통 금융, 의료 등 컴플라이언스 요건에 따라 파일의 모든 이전 버전을 장기 저장해야 하는데, 이때 라이프사이클 기능을 사용해 이전 버전 파일을 아카이브로 전환하는 작업을 수행할 수 있습니다.

## 설정 요소

### 작업

- 데이터 전환: 생성된 객체를 지정 시간 후 표준IA 스토리지 유형, INTELLIGENT TIERING, CAS 및 DEEP ARCHIVE 유형으로 전환할 수 있습니다.
- 만료 삭제: 객체의 만료시간을 설정하면 객체가 만료된 후 자동으로 삭제됩니다.

### 리소스

- 접두사 구분: 접두사 규칙에 매칭되는 객체는 모두 규칙에 따라 처리됩니다.
- 버전 관리: 현재 버전이 아닌 객체는 규칙에 따라 처리됩니다.
- 삭제 표기: 객체 이전 버전이 모두 지워지면 삭제 표기를 제거하도록 지정할 수 있습니다.
- 미완성 멀티파트 업로드: 미완성 멀티파트 업로드 작업에 대한 처리를 수행합니다.

### 시간 조건

- 일별 계산: 규칙에 대응하는 동작이 객체가 마지막으로 수정된 날짜 후 며칠이 지나서 작업할 지 지정합니다.
- 날짜별 계산: 규칙에 대응하는 동작이 지정된 날짜에 작업을 실행하도록 지정합니다.

## 사용 설명

### 데이터 전환

#### 지원 리전

공유 클라우드 리전을 지원합니다.

#### 단방향 원칙

데이터 전환은 단방향 즉, 표준 스토리지>표준IA 스토리지>INTELLIGENT TIERING>CAS>DEEP ARCHIVE만 허용하고, 등급 뛰어넘기 전환(예시: 표준 스토리지>표준IA 스토리지)도 지원하지만 역방향은 지원하지 않습니다. [PUT Object - Copy](https://intl.cloud.tencent.com/document/product/436/10881)(CAS/DEEP ARCHIVE가 아닌 유형 대상) 또는 [POST Object restore](https://intl.cloud.tencent.com/document/product/436/12633)(CAS/DEEP ARCHIVE 유형에만 적용됨) 호출을 통해서만 콜드 스토리지 유형의 데이터를 핫 스토리지 유형으로 복구할 수 있습니다.

#### 최종 일관성

같은 그룹에 속한 객체에 여러 규칙을 설정하고, 충돌적 상황(만료 삭제 설정 불포함)이 존재할 경우, COS는 우선적으로 가장 콜드한 스토리지 유형의 규칙으로 전환합니다. 예를 들어, 같은 그룹에 **표준IA 스토리지로 전환** 및 **CAS로 전환** 규칙을 설정하면 우선적으로 **CAS로 전환** 규칙을 수행합니다.
>!Tencent Cloud COS는 동일한 그룹의 객체에 여러 충돌성 조건을 가진 라이프사이클 규칙을 설정하지 말 것을 강력히 권고합니다. 실행이 충돌하면 추가 요금이 발생할 수 있습니다.

### 만료 삭제

#### 처리 로직

객체가 지정한 라이프사이클이 만료 삭제되는 규칙에 매칭될 경우, Tencent Cloud는 대상을 비동기화된 삭제 큐에 추가하여 실제 발생한 삭제 시간은 생성 시간과 일정하게 딜레이됩니다. GET 또는 HEAD Object 작업을 통해 객체의 현재 상태를 얻을 수 있습니다.

#### 최종 일관성
같은 그룹에 속한 객체에 여러 규칙을 설정하고, 충돌 상황이 존재할 경우, COS는 최단 기간의 만료 시간을 기준으로 실행하고, **만료 삭제의 실행 효과는 전환 스토리지 유형보다 크게 됩니다.**

>! Tencent Cloud COS는 동일한 그룹의 객체에 여러 충돌성 조건을 가진 라이프사이클 규칙을 설정하지 말 것을 강력히 권고합니다. 실행이 충돌하면 추가 요금이 발생할 수 있습니다.
>

### 비용 참고

#### 수행 설명

어떤 시간으로 전달된 설정에 대해서 Tencent Cloud COS는 베이징 시간(GMT+8) 다음날 0시를 기준으로 작업을 수행하기 시작합니다. 비동기 큐가 수행되므로 설정 후 업로드하는 객체가 규칙에 매칭되면 통상 아무리 늦어도 다음날 24시 이전에 작업을 완료합니다.

예를 들어 1일 오후 3시에 파일을 수정하고 1일 후에 삭제되는 라이프사이클 규칙을 설정한 경우, 라이프 사이클 작업은 2일 0시에 파일 스캔을 시작하여, 2일 0시를 기준으로 최종 수정 시간이 1일을 넘은 파일에 대한 삭제 작업을 실행합니다. 1일 당일 업로드한 파일은 최종 수정 시간을 기준으로 1일을 초과하지 않았기 때문에 3일 0시까지 기다려야만 기록을 스캔하고 삭제를 실행할 수 있습니다.

라이프사이클 수행 효력은 의외의 상황이나 버킷에 대량의 인벤토리 객체를 포함한 상황을 포함하지 않습니다. 기타 상황으로 인해 완료하지 못하면 GET 또는 HEAD Object 작업을 통해 객체의 현재 상태를 얻을 수 있습니다.

현재 Tencent Cloud는 라이프사이클의 수행 효과에 대해 청구서 약속을 제공하지 않습니다. 즉, 객체의 과금은 라이프사이클 수행 완료 시 변화가 발생합니다.

#### 시간에 예민하지 않음

표준IA 스토리지 및 INTELLIGENT TIERING 유형은 최소 30일, CAS 유형은 최소 90일, DEEP ARCHIVE 유형은 최소 180일 저장하여, 데이터 전환 또는 삭제 수행 시 별도의 스토리지 요금이 발생하지 않도록 주의하십시오. Tencent Cloud COS는 30/90/180일 이하의 라이프사이클 설정은 검사하지 않으므로 정확한 설정은 귀하의 요구에 따라 수행됩니다.

예를 들어, CAS의 객체가 30일 미만일 때 전환되면, 객체는 당일 CAS 유형 요금을 발생시키는 동시에 표준IA 스토리지 유형은 30일째까지만 과금하게 됩니다. CAS 객체가 90일 미만일 때 만료 삭제되면, 객체는 계속 CAS 유형으로 90일째까지 과금됩니다. 데이터가 DEEP ARCHIVE로 전환되는 것과 같은 이치입니다.

#### 크기에 구애받지 않음

표준IA 스토리지, INTELLIGENT TIERING, CAS 및 DEEP ARCHIVE 유형에 각각 객체 최소 점유 용량 제한을 만들었습니다. 예를 들어 표준IA 스토리지에서 64KB 이하 파일을 업로드하면 64KB로 계산됩니다. Tencent Cloud COS는 파일의 크기를 검사하지 않고 무조건 지정된 규칙에 따라 객체의 전환 작업을 수행합니다. 

>?라이프사이클은 0바이트의 객체에 대해 전환 작업을 수행하지 않습니다.
