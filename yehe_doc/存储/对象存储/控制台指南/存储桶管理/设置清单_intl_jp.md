## 概要

[COSコンソール](https://console.cloud.tencent.com/cos5)から、バケットのリスト機能をアクティブ化することができます。リスト機能をアクティブ化すると、毎日または毎週定期的に、オブジェクトの属性、設定の詳細などに関するリストレポートをお客様のバケットに出力することができます。リストに関するその他の詳細については、[リスト機能の概要](https://intl.cloud.tencent.com/document/product/436/30622)をご参照ください。次に、バケットリスト機能をアクティブ化する方法について詳しくご説明します。タイミングリストとリアルタイムリストをサポートしており、お客様は必要に応じて選択できます。

>!
>- ユーザーは1つのバケットに複数のリストタスクを設定することができます。
> - リストタスクは、オブジェクトの内容を直接読み取るのではなく、オブジェクトのメタデータなどのプロパティ情報をスキャンするだけです。
> 

##  前提条件

バケットを作成します。詳細については、[バケットの作成](https://intl.cloud.tencent.com/document/product/436/13309)のドキュメントをご参照ください。

## 操作手順

### タイミングリストの追加

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインします。
2. 左側ナビゲーションバーで、**バケットリスト**をクリックします。
3. リスト機能をアクティブ化したいバケット（ソースバケット）をクリックして進みます。
4. 左側ナビゲーションバーで、**基本設定>リストの設定**を選択し、**リストの追加**をクリックします。
5. 設定ページでは、以下の設定を行うことができます。
 1. 基本情報
    - **ルールステータス**：現在のリストルールを有効にするかどうかです。リストの有効/無効を選択できます。
    - **リスト名**：リスト名を入力します。
    - **ターゲットバケット**：リストをストレージするバケットのことです。最初のデフォルトのターゲットバケットはソースバケットです。ターゲットバケットは、ソースバケットと同じリージョンにある必要があります。
    - **リストレポートプレフィックス（オプション）**：ターゲットバケット用に選択したプレフィックスを入力すると、パブリックロケーションのリストファイルをグループ化できます。初期値はデフォルト値です。
 2. フィルタリング条件
    - **ファイル範囲**：リストオブジェクトの範囲について、バケット全体か、指定したファイルプレフィックスかを選択します。選択されていない場合、デフォルトでバケット全体になります。
	- **オブジェクトバージョン**：リストにオブジェクトのすべてのバージョンを含めるか、現在のバージョンのみを含めるかを選択します。選択しない場合、デフォルトで現在のバージョンのみが保持されます。
	- **フィルタリングタグ（オプション）**：フィルタリングにより、タグが同じオブジェクトをリストに入れます。入力されていない場合、デフォルトではフィルタリングは行われません。
	- **フィルタリング時間（オプション）**：フィルタリングにより、変更時刻が特定の時点以降または特定の時間帯のオブジェクトをリストに入れます。設定されていない場合、デフォルトではフィルタリングは行われません。
	- **リスト情報**：リストレポートに含める必要のあるオブジェクトに対応する情報を選択します。選択可能な項目には、オブジェクトサイズ、ストレージクラス、ETag、バケットコピーのステータス、マルチパートアップロードのステータス、最新の更新日、タグ、CRC64があります。選択されていない場合、デフォルトですべてが選択されます。
>?
>- ETag（エンティティタグ）とはオブジェクトのハッシュです。ETag はオブジェクトの内容への変更のみを反映し、メタデータへの変更は反映しません。ETagは、必ずしもオブジェクトデータのMD5ダイジェストではなく、オブジェクトの作成方法と暗号化方法によって決まります。
>- 発行されるリストの内容にはデフォルトでAppid、Bucket、Key、LastModifiedTimeフィールドが含まれます。
>- バケットでバージョン管理を有効化している場合は、発行されるリストの内容にVersionId、IsLatest、IsDeleteMarkerフィールドが追加されます。
>
 3. 出力形式
	- **出力形式**：リストファイルの出力形式は、GZIPを使用して圧縮したCSVファイルです。
	- **発行サイクル**：リストを毎日/毎週発行するかを選択します。デフォルトでは毎日発行します。例えば、当日の15時にリストを追加した場合、通常は遅くとも翌日の6時にはリストファイルが発行されてターゲットバケットに配信されます。毎週発行を選択した場合は7日間周期でリストが発行されます。例えば9月1日にリストを有効化した場合、9月2日、9月9日、9月16日......のように、7日間周期でリストが発行されます。
	- **リスト暗号化**：リストにサーバー側の暗号化が必要かどうかを選択します。次のいずれかを選択できます。
		 - 暗号化なし：リストの暗号化を行いません。これはデフォルト項目です。
		 - SSE-COS：COSホストキーのサーバー側の暗号化を使用してレポートを暗号化します。詳細については、COS開発者ガイドの[SSE-COS暗号化](https://intl.cloud.tencent.com/document/product/436/18145)をご参照ください。
	- **アクセス承認**：デフォルトでは無効になっています。アクセス承認が有効になると、次のステップの操作に進むことができます。
 4. 情報の確認
バケットのリスト設定情報を確認します。変更したい場合は、**前へ戻る**をクリックします。
6. 設定情報が正しいことを確認したら、**OK**をクリックすれば完了です。それ以降、COSは毎日または毎週、リストファイルを自動発行し、設定したターゲットバケットに配信します。
>? リスト機能によって発行されるリストレポートの形式と内容の詳細については、[リスト機能の概要](https://intl.cloud.tencent.com/document/product/436/30622)をご参照ください。
>

### リアルタイムリストの発行

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインします。
2. 左側ナビゲーションバーで**バケットリスト**をクリックし、リスト機能をアクティブ化したいバケット（ソースバケット）をクリックして進みます。
3. 左側の**基本設定>リストの設定**をクリックし、リストルールを選択します。右側の**リアルタイム発行リスト**をクリックすると、リアルタイムリストが発行されます。
>? 
>- リアルタイムリストを発行するには、既存のリストの操作列で、**リアルタイム発行リスト**をクリックすれば完了です。
>- リストを設定していない場合は、まずリストを設定してからリアルタイムリストを発行してください。
>


