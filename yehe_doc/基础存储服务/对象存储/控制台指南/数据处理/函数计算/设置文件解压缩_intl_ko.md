## 소개

파일 압축 해제 기능은 Tencent Cloud COS가 [Serverless Cloud Function](https://intl.cloud.tencent.com/document/product/583)을 기반으로 사용자에게 제공하는 데이터 처리 솔루션입니다. 버킷에 파일 압축 해제 규칙 추가 후, COS에 압축 파일을 업로드하면 COS에서 자동으로 설정해 놓은 SCF를 트리거하여 파일을 지정한 버킷 및 경로에 압축 해제합니다. 파일 압축 해제 과정은 다음 이미지와 같습니다.

![Decompression Flow](https://main.qcloudimg.com/raw/4899b5c92bb085a0f18a522dfae344ae.jpg)



## 주의 사항

- 파일 압축 해제는 ZIP 형식 파일의 압축 해제만 지원합니다.
- 이전에 COS 콘솔에서 버킷에 파일 압축 해제 규칙을 추가한 경우, [SCF 콘솔](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)에서 생성한 파일 압축 해제 함수를 확인할 수 있습니다. 해당 파일 압축 해제 함수는 삭제하지 **마십시오.** 삭제할 경우 규칙이 적용되지 않습니다.
- 이미 런칭된 SCF의 리전에서는 ZIP 패키지 압축 해제를 지원합니다. 이에는 광저우, 상하이, 베이징, 청두, 중국홍콩, 싱가포르, 뭄바이, 토론토, 실리콘밸리 등이 포함되어 있으며, 지원하는 리전에 대한 자세한 내용은 [SCF 제품 문서](https://intl.cloud.tencent.com/document/product/583)를 참고하십시오.
- 압축 파일의 디렉터리 또는 파일 이름은 반드시 UTF-8 또는 GB 2312 인코딩을 사용하십시오. 그렇지 않을 경우 압축 해제 후 파일 이름 또는 디렉터리 이름이 깨지거나 압축 해제 프로세스가 중단되는 등의 상황이 발생할 수 있습니다. 오류가 발생하는 경우 생성한 함수 오른쪽에 있는 **로그 조회**를 클릭하여 SCF 콘솔로 이동해 로그의 오류 상세 정보를 확인할 수 있습니다.
- 아카이브 유형의 파일은 압축 해제를 지원하지 않습니다. 아카이브 유형의 압축 파일을 압축 해제하려면 복구가 선행되어야 합니다. 복구 방법은 [보관된 객체 복구](https://intl.cloud.tencent.com/document/product/436/30961)를 참고하십시오.
- 단일 압축 파일의 최대 압축 해제 프로세스 시간은 900초이며, 900초를 초과하여도 압축 해제 작업이 완료되지 않을 경우 실패됩니다. COS의 압축 해제 기능 제한에 대한 설명은 SCF 서비스를 기반으로 하며, 기타 제한에 대한 자세한 내용은 [SCF Quota Limits](https://intl.cloud.tencent.com/document/product/583/11637)를 참고하십시오.
- COS의 압축 해제 기능은 SCF 서비스에 종속되며, SCF 서비스는 사용자에게 [Free Tier](https://intl.cloud.tencent.com/document/product/583/12282)를 제공하고, 무료 한도를 초과한 부분에 대해서는 [SCF Pricing](https://intl.cloud.tencent.com/document/product/583/12281)에 따라 과금됩니다. 압축 해제 기능 사용 시 압축파일이 너무 큰 경우 더 많은 리소스 사용량이 소모되며, 압축 해제 횟수가 많을수록 더 많은 호출 횟수가 소모됩니다.

## 작업 단계

1. [COS 콘솔](https://console.cloud.tencent.com/cos5)에 로그인합니다.
2. 왼쪽 사이드바에서 **버킷 리스트**를 선택합니다.
3. 파일 압축 해제 규칙을 추가할 버킷 이름을 클릭하여 해당 버킷 관리 페이지로 이동합니다. 
4. 왼쪽 사이드바에서 **함수 계산**을 선택하고 **ZIP 파일 압축 해제 함수**를 클릭한 다음 ZIP 파일 압축 해제 함수 설정 페이지로 들어갑니다.
>! SCF를 활성화하지 않은 경우 [SCF 콘솔](https://console.cloud.tencent.com/scf)로 이동하여 SCF 서비스를 활성화하고 안내에 따라 서비스 라이선스를 완료합니다.
5. **함수 추가**를 클릭한 후, 팝업창에서 다음 정보를 설정합니다.

 - **함수 이름**: 함수 이름은 함수의 고유한 식별자로, 생성 후에는 수정할 수 없습니다. [SCF 콘솔](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)에서 해당 함수를 확인할 수 있습니다.
 - **이벤트 유형**: 이벤트란 SCF를 트리거하는 작업을 뜻합니다. 업로드 작업을 예로 들면, 업로드 방식은 'PUT Object' 인터페이스 호출 또는 'POST Object' 인터페이스 호출일 수 있으며, 이벤트 **Put 메소드 생성**을 선택하면 'PUT Object' 인터페이스를 통해 업로드하는 압축 파일만 압축 해제를 트리거합니다.
>! 파일을 간편 업로드, 멀티파트 업로드, 리전 간 복제 등 다양한 방식을 통해 버킷에 업로드한 경우 **전체 생성** 이벤트 선택을 권장합니다.
>
 - **트리거 조건**: SCF를 트리거하는 압축 파일 업로드 경로를 의미합니다. 접두사 지정을 선택하는 경우 압축 파일을 지정된 접두사의 경로에 업로드할 때 SCF가 트리거되며, 접두사 지정하지 않음을 선택하는 경우, 압축 파일을 버킷의 어떤 위치에 업로드 하더라도 항상 트리거됩니다.
>! 설정한 타깃 파일 접두사와 트리거 조건 사이에 포함 관계가 있는 경우 순환 트리거가 발생할 수 있으므로, 이러한 상황이 발생하지 않도록 주의하십시오. 예를 들어 타깃의 접두사가 'prefix'이고, 트리거 조건이 'pre'이면 'pref' 압축파일 업로드 시 압축 해제가 순환 트리거됩니다.
>
 - **SCF 권한 부여**: 압축 해제 시, 사용자의 버킷에서 압축 파일을 읽어오고 압축 해제 후 파일을 지정한 위치에 업로드하는 권한을 SCF에 부여해야 하므로 해당 권한을 추가해야 합니다.
6. **다음 단계** 클릭 후 팝업창에서 다음 정보를 설정합니다.

 - **압축 해제 형식**: 현재는 ZIP 형식의 압축파일 해제만 지원합니다.
 - **전송 버킷**: 압축 해제된 파일을 저장할 버킷을 선택합니다.
 - **전송 경로**: 매칭된 파일을 이 타깃 디렉터리에 압축 해제합니다. 반복되는 트리거로 인한 불필요한 비용을 방지하기 위해 접두사와 다른 타깃 디렉터리를 설정할 것을 권장합니다.
 - **추가 접두사**:
    - 압축파일 이름: 압축파일 이름을 따라 명명된 접두사에 압축파일을 압축 해제할 수 있습니다.
    - 압축파일 전체 경로: 전체 압축파일 이름을 따라 명명된 접두사에 압축파일을 압축 해제할 수 있습니다.
>?예를 들어 압축된 패키지의 이름은 123.zip이며 abc 디렉터리에 저장될 경우 압축된 패키지 이름은 '123.zip'이고 압축된 패키지의 전체 경로는 'abc/123.zip'입니다.
>
    - 없음으로 설정: 압축파일의 파일을 전송 경로로 직접 압축 해제합니다.
 - **재귀 트리거 금지**: 활성화하면 압축 해제된 파일에 ZIP 패키지가 포함되어 있을 경우 압축 해제를 트리거할 수 없으며, 비활성화하면 압축 해제된 파일에 ZIP 패키지가 포함되어 있을 경우 트리거할 수 있습니다.
 - **콜백 주소**: 실제 필요에 따라 콜백 주소를 입력합니다.
6. 설정 사항을 확인한 후, **확인**을 클릭하면 추가 완료된 함수를 확인할 수 있습니다.
![](https://main.qcloudimg.com/raw/cb968ff99051f2eb1e515dd74000c1ee.png)
새로 생성한 함수에 다음과 같은 작업을 진행할 수 있습니다.
 - **로그**를 클릭하여 압축 해제 실행 이력을 확인합니다. 압축 해제에 오류가 발생한 경우, **로그**를 클릭하여 SCF 콘솔로 빠르게 이동해 로그 오류 상세 정보를 확인할 수 있습니다.
 - **더 보기 > 편집**을 클릭하여 파일 압축 해제 규칙을 수정합니다.
 - **더 보기 > 삭제**를 클릭하여 사용하지 않는 파일 압축 해제 규칙을 삭제합니다.
