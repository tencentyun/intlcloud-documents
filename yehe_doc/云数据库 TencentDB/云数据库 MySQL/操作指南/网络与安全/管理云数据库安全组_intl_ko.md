## 작업 시나리오
[보안 그룹](https://cloud.tencent.com/doc/product/213/500)은 스테이트풀 패킷 필터링 가상 방화벽의 일종으로, Tencent Cloud에서 제공하는 중요한 네트워크 보안 격리 방법이며, 단일 또는 다중 CDB의 네트워크 액세스 제어 설정에 사용됩니다. 보안 그룹은 하나의 로직 그룹으로서 같은 리전 안에서 같은 수준의 네트워크 보안 격리가 필요한 CDB 인스턴스를 같은 보안 그룹에 추가할 수 있습니다. CDB, CVM 등을 보안 그룹 리스트에 공유할 수 있으며, 보안 그룹 안에서 규칙에 따라 매칭됩니다.

>?
>- TencentDB for MySQL 보안 그룹은 현재 사설 네트워크(VPC)의 내부 및 외부 네트워크 액세스를 통한 네트워크 제어만 지원하며, 기본 네트워크를 통한 네트워크 제어는 현재 지원하지 않습니다.
>- 광저우, 상하이, 중국홍콩, 베이징, 청두, 충칭, 서울, 도쿄 리전에만 데이터베이스의 외부 네트워크를 통한 보안 그룹 액세스 기능을 지원하며, 그 외 리전은 현재 지원하지 않습니다.
>- CDB에는 자동 아웃바운드 트래픽이 없으므로 아웃바운드 규칙이 적용되지 않습니다.
>- TencentDB for MySQL 보안 그룹은 마스터 인스턴스, 읽기 전용 인스턴스 및 재해 복구 인스턴스를 지원합니다.
>- TencentDB for MySQL 기본 버전은 보안 그룹을 지원하지 않습니다.


## CDB에 보안 그룹 설정
### 1단계: 보안 그룹 생성
1. [CVM 콘솔](https://console.cloud.tencent.com/cvm/securitygroup)에 로그인합니다.
2. 왼쪽 메뉴의 [Security Group] 페이지에서 리전을 선택하고 [New]를 클릭합니다.
3. 팝업된 대화 상자에서 아래의 설정을 완료하고 [OK]를 클릭합니다.
 - 템플릿: 보안 그룹 내의 데이터베이스 인스턴스 수요에 따라 제공되는 서비스로, 아래 테이블과 같이 적합한 템플릿을 선택해 보안 그룹 규칙을 설정하는 과정을 간소화할 수 있습니다.
<table>
	<tr><th>템플릿<</th><th>설명<</th><th>설명</th></tr>
	<tr><td>모든 포트 개방</td><td>모든 포트를 공용 네트워크와 내부 네트워크에 개방하도록 기본 설정, 일정 수준의 보안 리스크 존재.</td><td>-</td></tr>
	<tr><td>22, 80, 443, 3389포트 및 ICMP 프로토콜 개방</td><td>기본으로 22, 80, 443, 3389포트 및 ICMP 프로토콜 개방, 내부 네트워크에는 전체 개방.</td><td>이 템플릿은 CDB에 적용되지 않음.</td></tr>
	<tr><td>사용자 정의</td><td>보안 그룹 생성을 완료하면 필요에 따라 보안 그룹 규칙을 추가해야 합니다. 자세한 작업 방식은 하단의 '보안 그룹 규칙 추가' 참조</a>.</td><td>-</rd></tr>
</table>
 - 이름: 보안 그룹의 이름은 사용자가 지정합니다.
 - 서브 항목: '기본 항목'을 선택하도록 기본 설정, 이후 관리상 편의를 위해 기타 항목을 지정할 수 있습니다.
 - 비고: 사용자 정의, 이후 관리상 편의를 위해 보안 그룹에 대해 간략히 설명할 수 있습니다.


 <span id="Step2"></span>
### 2단계: 보안 그룹 규칙 추가
1. [보안 그룹 페이지](https://console.cloud.tencent.com/cvm/securitygroup)로 이동하고, 규칙 설정이 필요한 보안 그룹 행의 'Operation' 열에서 [Modify Rules]를 클릭합니다.
2. <span id="step02">보안 그룹 규칙 페이지에서 [Inbound rule]>[Add a Rule]를 선택합니다.</span>
3. 팝업된 대화 상자에서 규칙을 설정합니다.
 - 유형: '사용자 정의'로 기본 선택되며, 다른 시스템의 규칙 템플릿을 선택할 수도 있습니다. MySQL(3306) 템플릿을 선택하시기를 권장합니다.
 - 출처: 트래픽의 소스(인바운드 규칙) 또는 타깃(아웃바운드 규칙)으로, 다음 옵션 중 하나를 지정하시기 바랍니다.
<table>
	<tr><th>지정한 소스/타깃</th><th>설명</th></tr>
	<tr><td>단일 IPv4 주소 또는 IPv4 주소 범위</td><td>CIDR 표시법(예: <code>203.0.113.0</code>, <code>203.0.113.0/24</code> 또는 <code>0.0.0.0/0</code>, 그중에서 <code>0.0.0.0/0</code>은 모든 IPv4 주소에 매칭함을 의미) 사용.</td></tr>
	<tr><td>단일 IPv6 주소 또는 IPv6 주소 범위</td><td>CIDR 표시법(예: <code>FF05::B5</code>, <code>FF05:B5::/60</code>, <code>::/0</code> 또는 <code>0::0/0</code>, 그중에서 <code>::/0</code> 또는 <code>0::0/0</code>은 모든 IPv6 주소에 매칭함을 의미) 사용.</td></tr>
	<tr><td>보안 그룹 ID 참조, 아래의 보안 그룹 ID를 참조할 수 있습니다. <ul  style="margin: 0;"><li>보안 그룹 ID</li><li>기타 보안 그룹</li></ul>
</td><td><ul  style="margin: 0;"><li>현재 보안 그룹, 보안 그룹에 연결된 CVM 표시.</li><li>기타 보안 그룹, 같은 지역 및 같은 항목에 있는 또 다른 보안 그룹 ID 표시.</li></ul>
</td></tr>
	<tr><td><a href="https://intl.cloud.tencent.com/document/product/215/31867">매개변수 템플릿</a>의 IP 주소 객체 또는 IP 주소 그룹 객체 참조</td><td>-</td></tr>
</table>
 - 프로토콜 포트: 프로토콜 유형과 포트 범위를 입력하거나, [매개변수 템플릿](https://intl.cloud.tencent.com/document/product/215/31867)의 프로토콜 포트 또는 프로토콜 그룹을 참조할 수 있습니다.
  >?TencentDB for MySQL에 연결하려면 3306 프로토콜 포트를 반드시 활성화해야 합니다.
 - 정책: '허용'으로 기본 설정됩니다.
    - 허용: 이 포트에 해당하는 액세스 요청을 허용합니다.
    - 차단: 즉시 데이터 패킷을 손실시키고, 어떠한 응답 정보도 반환하지 않습니다.
 - 비고: 사용자 정의, 이후 관리상 편의를 위해 규칙에 대해 간략히 설명할 수 있습니다.
4. <span id="step04">[Compelete]를 클릭해 보안 그룹 인바운드 규칙 추가를 완료합니다.</span>

#### 사례
**시나리오: **TencentDB for MySQL을 생성한 후에, CVM을 통해 TencentDB for MySQL에 액세스하고자 하는 상황.
**해결 방법: **보안 그룹 규칙을 추가할 때 [Types]에서 MySQL(3306)을 선택하여 3306번 프로토콜 포트를 개방합니다.
이외에도 실제 수요에 따라 전체 IP 또는 지정 IP(IP 세그먼트)를 개방하여, CVM을 통해 TencentDB for MySQL의 IP 출처에 액세스할 수 있도록 설정할 수 있습니다.

| 방향 | 유형 | 출처 | 프로토콜 포트 | 정책 |
|---------|---------|---------|---------|---------|
| 인바운드 | MySQL(3306)  | 전체 IP: 0.0.0.0/0<br>지정 IP: 지정할 IP 또는 IP 세그먼트 입력 | TCP:3306 | 허용 |
               

### 3단계: 보안 그룹 설정
보안 그룹은 Tencent Cloud에서 제공하는 인스턴스 수준별 방화벽으로, CDB의 인바운드 트래픽을 제어할 수 있습니다. 인스턴스를 구매할 때 보안 그룹을 바인딩하거나, 구매 이후 콘솔에서 바인딩할 수 있습니다.

>!현재 TencentDB for MySQL의 보안 그룹은 **VPC CDB** 설정만 지원합니다.

1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 뒤, Instance List에서 인스턴스 이름을 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지의 [Security Group]에서 [Security Group Settings]를 클릭합니다.
3. 팝업된 대화 상자에서 바인딩할 보안 그룹을 선택하고 [OK]를 클릭하면 보안 그룹을 CDB에 바인딩할 수 있습니다. 

## 보안 그룹 규칙 가져오기
1. [보안 그룹 페이지](https://console.cloud.tencent.com/cvm/securitygroup)에서 필요한 보안 그룹을 선택하고 보안 그룹 ID/이름을 클릭합니다.
2. 인바운드/아웃바운드 규칙 탭에서 [Import rule]을 클릭합니다.
3. 팝업된 대화 상자에서 편집이 완료된 인바운드/아웃바운드 규칙 템플릿 파일을 선택하고 [Import]를 클릭합니다.
> ?이미 보안 그룹 규칙이 있는 보안 그룹에 새 규칙을 가져오면 기존 규칙을 덮어쓰므로, 새로 가져오기 전에 기존 규칙을 먼저 내보내시길 권장합니다.
	

## 보안 그룹 클론
1. [보안 그룹 페이지](https://console.cloud.tencent.com/cvm/securitygroup)로 이동하고, 리스트의 'Operation' 열에서 [More]>[Clone]을 선택합니다.
2. 팝업된 대화 상자에서 타깃 리전, 타깃 항목을 선택한 다음 [OK]를 클릭합니다. 만약 새 보안 그룹에 CVM을 연결해야 한다면 다시 보안 그룹 관리로 이동해 CVM을 연결하시기 바랍니다.

## 보안 그룹 삭제
1. [보안 그룹 페이지](https://console.cloud.tencent.com/cvm/securitygroup)에서 삭제할 보안 그룹을 선택하고, 'Operation' 열에서 [More]>[Delete]를 클릭합니다.
2. 팝업된 대화 상자에서 [OK]를 클릭합니다. 현재 보안 그룹에 연결된 CVM이 있다면 먼저 보안 그룹 연결을 해제해야만 삭제할 수 있습니다.

